"use strict";function t(t){var n=Object.create(null);return t&&Object.keys(t).forEach((function(e){if("default"!==e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})}})),n.default=t,Object.freeze(n)}var n=t(require("bigint-crypto-utils"));class e{constructor(t,n){this.n=t,this._n2=this.n**2n,this.g=n}get bitLength(){return n.bitLength(this.n)}encrypt(t,e){if(void 0===e)do{e=n.randBetween(this.n)}while(1n!==n.gcd(e,this.n));return n.modPow(this.g,t,this._n2)*n.modPow(e,this.n,this._n2)%this._n2}addition(...t){return t.reduce(((t,n)=>t*n%this._n2),1n)}plaintextAddition(t,...e){return e.reduce(((t,e)=>t*n.modPow(this.g,e,this._n2)%this._n2),t)}multiply(t,e){return n.modPow(t,e,this._n2)}}class i{constructor(t,n,e,i,r){this.lambda=t,this.mu=n,this._p=i,this._q=r,this.publicKey=e}get bitLength(){return n.bitLength(this.publicKey.n)}get n(){return this.publicKey.n}decrypt(t){return r(n.modPow(t,this.lambda,this.publicKey._n2),this.publicKey.n)*this.mu%this.publicKey.n}getRandomFactor(t){if(this.publicKey.g!==this.n+1n)throw RangeError("Cannot recover the random factor if publicKey.g != publicKey.n + 1. You should generate yout keys using the simple variant, e.g. generateRandomKeys(3072, true) )");if(void 0===this._p||void 0===this._q)throw Error("Cannot get random factor without knowing p and q");const e=this.decrypt(t),i=(this._p-1n)*(this._q-1n),r=n.modInv(this.n,i),o=t*(1n-e*this.n)%this.publicKey._n2;return n.modPow(o,r,this.n)}}function r(t,n){return(t-1n)/n}function o(t,e){const i=n.randBetween(t),r=n.randBetween(t);return(i*t+1n)*n.modPow(r,t,e)%e}exports.PrivateKey=i,exports.PublicKey=e,exports.generateRandomKeys=async function(t=3072,s=!1){let h,c,u,a,d,l;do{h=await n.prime(Math.floor(t/2)+1),c=await n.prime(Math.floor(t/2)),u=h*c}while(c===h||n.bitLength(u)!==t);if(s)a=u+1n,d=(h-1n)*(c-1n),l=n.modInv(d,u);else{const t=u**2n;a=o(u,t),d=n.lcm(h-1n,c-1n),l=n.modInv(r(n.modPow(a,d,t),u),u)}const p=new e(u,a);return{publicKey:p,privateKey:new i(d,l,p,h,c)}},exports.generateRandomKeysSync=function(t=3072,s=!1){let h,c,u,a,d,l;do{h=n.primeSync(Math.floor(t/2)+1),c=n.primeSync(Math.floor(t/2)),u=h*c}while(c===h||n.bitLength(u)!==t);if(s)a=u+1n,d=(h-1n)*(c-1n),l=n.modInv(d,u);else{const t=u**2n;a=o(u,t),d=n.lcm(h-1n,c-1n),l=n.modInv(r(n.modPow(a,d,t),u),u)}const p=new e(u,a);return{publicKey:p,privateKey:new i(d,l,p,h,c)}};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgubm9kZS5janMiLCJzb3VyY2VzIjpbIi4uL3NyYy90cy9QdWJsaWNLZXkudHMiLCIuLi9zcmMvdHMvUHJpdmF0ZUtleS50cyIsIi4uL3NyYy90cy9nZW5lcmF0ZVJhbmRvbUtleXMudHMiXSwic291cmNlc0NvbnRlbnQiOm51bGwsIm5hbWVzIjpbIlB1YmxpY0tleSIsImNvbnN0cnVjdG9yIiwibiIsImciLCJ0aGlzIiwiX24yIiwiYml0TGVuZ3RoIiwiYmN1IiwiZW5jcnlwdCIsIm0iLCJyIiwidW5kZWZpbmVkIiwicmFuZEJldHdlZW4iLCJnY2QiLCJtb2RQb3ciLCJhZGRpdGlvbiIsImNpcGhlcnRleHRzIiwicmVkdWNlIiwic3VtIiwibmV4dCIsInBsYWludGV4dEFkZGl0aW9uIiwiY2lwaGVydGV4dCIsInBsYWludGV4dHMiLCJtdWx0aXBseSIsImMiLCJrIiwiUHJpdmF0ZUtleSIsImxhbWJkYSIsIm11IiwicHVibGljS2V5IiwicCIsInEiLCJfcCIsIl9xIiwiZGVjcnlwdCIsIkwiLCJnZXRSYW5kb21GYWN0b3IiLCJSYW5nZUVycm9yIiwiRXJyb3IiLCJwaGkiLCJuSW52TW9kUGhpIiwibW9kSW52IiwiYzEiLCJhIiwiZ2V0R2VuZXJhdG9yIiwibjIiLCJhbHBoYSIsImJldGEiLCJhc3luYyIsImJpdGxlbmd0aCIsInNpbXBsZVZhcmlhbnQiLCJwcmltZSIsIk1hdGgiLCJmbG9vciIsImxjbSIsInByaXZhdGVLZXkiLCJwcmltZVN5bmMiXSwibWFwcGluZ3MiOiJ3VEFLYyxNQUFPQSxFQVduQkMsWUFBYUMsRUFBV0MsR0FDdEJDLEtBQUtGLEVBQUlBLEVBQ1RFLEtBQUtDLElBQU1ELEtBQUtGLEdBQUssR0FDckJFLEtBQUtELEVBQUlBLENBQ1YsQ0FNR0csZ0JBQ0YsT0FBT0MsRUFBSUQsVUFBVUYsS0FBS0YsRUFDM0IsQ0FVRE0sUUFBU0MsRUFBV0MsR0FDbEIsUUFBVUMsSUFBTkQsRUFDRixHQUNFQSxFQUFJSCxFQUFJSyxZQUFZUixLQUFL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
